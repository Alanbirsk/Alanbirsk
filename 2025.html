<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Dashboard de Implantações • 2025</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  padding:32px;
  background:#020617;
  color:#e5e7eb;
  font-family:Inter, sans-serif;
}
h1{text-align:center;margin-bottom:28px}

.filters{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:16px;
  margin-bottom:28px;
}
select{
  padding:10px;
  background:#020617;
  color:#fff;
  border:1px solid #1f2933;
  border-radius:10px;
}

.kpis{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(230px,1fr));
  gap:20px;
  margin-bottom:32px;
}
.kpi{
  border:1px solid #1f2933;
  border-radius:18px;
  padding:20px;
}
.kpi h3{
  margin:0;
  font-size:12px;
  color:#9ca3af;
  text-transform:uppercase;
}
.kpi span{
  display:block;
  margin-top:6px;
  font-size:24px;
  font-weight:700;
}

.card{
  border:1px solid #1f2933;
  border-radius:20px;
  padding:26px;
  margin-bottom:30px;
}

table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}
th,td{
  padding:10px;
  border-bottom:1px solid #1f2933;
  text-align:right;
}
th:first-child,td:first-child{text-align:left}
th{color:#9ca3af}
</style>
</head>

<body>

<h1>Implantações Finalizadas e Comissão • 2025</h1>

<!-- FILTROS -->
<div class="filters">
  <select id="consultorFilter">
    <option value="all">Todos os Consultores</option>
  </select>
  <select id="mesInicio"></select>
  <select id="mesFim"></select>
</div>

<!-- KPIs -->
<div class="kpis">
  <div class="kpi">
    <h3>Total de Implantações</h3>
    <span id="kpiQtd">0</span>
  </div>
  <div class="kpi">
    <h3>Total de Comissão (R$)</h3>
    <span id="kpiValor">R$ 0</span>
  </div>
  <div class="kpi">
    <h3>Consultor com Mais Implantações</h3>
    <span id="kpiTopQtd">-</span>
  </div>
  <div class="kpi">
    <h3>Consultor com Maior Comissão</h3>
    <span id="kpiTopValor">-</span>
  </div>
</div>

<!-- GRÁFICOS -->
<div class="card">
  <canvas id="graficoQtd"></canvas>
</div>

<div class="card">
  <canvas id="graficoValor"></canvas>
</div>

<!-- TABELA -->
<div class="card">
  <table>
    <thead>
      <tr>
        <th>Mês</th>
        <th>Implantações Finalizadas</th>
        <th>Comissão Total (R$)</th>
      </tr>
    </thead>
    <tbody id="tabela"></tbody>
  </table>
</div>

<script>
const meses=['Jan','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'];
const consultores=['Vitor','Carlos','Kaio','Jose','Lucas','Paulo'];

/* QUANTIDADE DE IMPLANTAÇÕES */
const qtd=[
 [3,0,5,6,2,0],
 [5,3,1,2,2,0],
 [3,4,2,1,5,0],
 [9,5,1,5,4,0],
 [3,5,0,3,11,0],
 [8,5,0,6,8,0],
 [6,5,0,9,4,0],
 [7,8,1,7,9,0],
 [6,5,3,9,7,0],
 [10,11,6,2,4,7],
 [8,0,2,4,6,0],
 [21,3,3,4,7,7]
];

/* COMISSÃO (PAULO = 0 EM TODOS OS MESES) */
const valor=[
 [220.96,0,1992.60,410.47,260.64,0],
 [579.28,486.96,213.44,535.20,190.72,0],
 [328.48,288.43,544.42,56.72,753.20,0],
 [2358.11,862.96,1249.50,241.92,746.74,0],
 [644.61,585.20,0,379.09,1025.37,0],
 [836.80,531.36,0,385.20,935.44,0],
 [526.40,643.52,0,1108.48,614.50,0],
 [898.80,1198.40,356.25,1444.42,638.08,0],
 [1421.74,504.52,798.97,993.10,1370.41,0],
 [1077.94,880.40,1186.20,310.48,491.12,0],
 [2057.28,0,890.00,360.86,690.29,0],
 [1430.78,302.40,795.53,322.56,804.19,0]
];

// POPULA FILTROS
const cSel=document.getElementById('consultorFilter');
consultores.forEach((c,i)=>cSel.innerHTML+=`<option value="${i}">${c}</option>`);

const mi=document.getElementById('mesInicio');
const mf=document.getElementById('mesFim');
meses.forEach((m,i)=>{
  mi.innerHTML+=`<option value="${i}">${m}</option>`;
  mf.innerHTML+=`<option value="${i}">${m}</option>`;
});
mf.value=11;

// GRÁFICOS
const gQtd=new Chart(document.getElementById('graficoQtd'),{
  type:'bar',
  data:{labels:[],datasets:[]},
  options:{
    plugins:{
      title:{display:true,text:'Quantidade de Implantações Finalizadas por Mês'},
      tooltip:{callbacks:{label:c=>` Implantações Finalizadas: ${c.raw}`}},
      legend:{display:false}
    }
  }
});

const gValor=new Chart(document.getElementById('graficoValor'),{
  type:'bar',
  data:{labels:[],datasets:[]},
  options:{
    plugins:{
      title:{display:true,text:'Valor de Comissão Paga por Mês (R$)'},
      tooltip:{callbacks:{label:c=>` Comissão Paga: R$ ${c.raw.toLocaleString('pt-BR',{minimumFractionDigits:2})}`}},
      legend:{display:false}
    },
    scales:{
      y:{ticks:{callback:v=>'R$ '+v.toLocaleString('pt-BR')}}
    }
  }
});

function atualizar(){
  const ci=cSel.value;
  const ini=+mi.value;
  const fim=+mf.value;

  let labels=[],dq=[],dv=[];
  let tq=0,tv=0;

  for(let i=ini;i<=fim;i++){
    const q=ci==='all'?qtd[i].reduce((a,b)=>a+b,0):qtd[i][ci];
    const v=ci==='all'?valor[i].reduce((a,b)=>a+b,0):valor[i][ci];
    labels.push(meses[i]);
    dq.push(q);
    dv.push(v);
    tq+=q;
    tv+=v;
  }

  document.getElementById('kpiQtd').innerText=tq;
  document.getElementById('kpiValor').innerText='R$ '+tv.toLocaleString('pt-BR',{minimumFractionDigits:2});

  if(ci==='all'){
    const totQtd=consultores.map((_,i)=>qtd.slice(ini,fim+1).reduce((s,m)=>s+m[i],0));
    const totVal=consultores.map((_,i)=>valor.slice(ini,fim+1).reduce((s,m)=>s+m[i],0));
    document.getElementById('kpiTopQtd').innerText=consultores[totQtd.indexOf(Math.max(...totQtd))];
    document.getElementById('kpiTopValor').innerText=consultores[totVal.indexOf(Math.max(...totVal))];
  }else{
    document.getElementById('kpiTopQtd').innerText=consultores[ci];
    document.getElementById('kpiTopValor').innerText=consultores[ci];
  }

  gQtd.data={labels,datasets:[{label:'Implantações Finalizadas (Qtd)',data:dq,backgroundColor:'#22c55e'}]};
  gValor.data={labels,datasets:[{label:'Comissão Paga (R$)',data:dv,backgroundColor:'#3b82f6'}]};
  gQtd.update();
  gValor.update();

  const tb=document.getElementById('tabela');
  tb.innerHTML='';
  labels.forEach((m,i)=>{
    tb.innerHTML+=`
      <tr>
        <td>${m}</td>
        <td>${dq[i]}</td>
        <td>R$ ${dv[i].toLocaleString('pt-BR',{minimumFractionDigits:2})}</td>
      </tr>`;
  });
}

document.querySelectorAll('select').forEach(s=>s.onchange=atualizar);
atualizar();
</script>

</body>
</html>
